{# U≈ºycie: w navbarze poka≈º ostatnie powiadomienia #}
{% if app.user %}
    {% set unread = notificationRepository.countUnread(app.user) %}
    <div class="dropdown">
        <button class="btn btn-light position-relative" data-bs-toggle="dropdown">
            üîî
            {% if unread > 0 %}
                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">{{ unread }}</span>
            {% endif %}
        </button>

        <div class="dropdown-menu dropdown-menu-end p-2" style="min-width: 320px;">
            <div class="fw-bold small mb-2">Powiadomienia</div>
            {% set items = notificationRepository.findLastForUser(app.user, 8) %}
            {% if items %}
                <ul class="list-unstyled small mb-0">
                    {% for n in items %}
                        <li class="mb-2">
                            <div class="{{ n.isRead ? 'text-muted' : '' }}">
                                <div class="fw-semibold">{{ n.title }}</div>
                                {% if n.body %}<div>{{ n.body }}</div>{% endif %}
                                <div class="text-muted">{{ n.createdAt|date('Y-m-d H:i') }}</div>
                                {% if n.reservation %}
                                    <a class="small" href="{{ path('app_reservations') }}">Szczeg√≥≈Çy‚Ä¶</a>
                                {% endif %}
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <div class="text-muted small">Brak powiadomie≈Ñ.</div>
            {% endif %}
        </div>
    </div>
{% endif %}
